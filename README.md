# Smart-parking-system-using-YOLOV7

YOLOv7 Smart Car Parking System
This project uses YOLOv7 object detection algorithm to detect and recognize vehicles in a parking lot, and keep track of the available parking spaces.

# Problem at hand
As a part of Smart Parking system, the problem is to identify available parking spots in the parking areas given bird’s eye view images of the parking lots captured by the cameras using Computer Vision and Image Processing.

# Solution Methodology

To find empty/available parking space from the input images of parking area, we divide the problem statement into two parts-
To obtain locations of parking spots in the images i.e which areas of the image correspond to parking spots. These locations will be used for subsequent images in the 3rd step.
For new input images, identify car instances and their locations in the parking lot and determine the occupancy using the reference locations as described in previous sections.

# Prerequisites

Python 3.x

PyTorch 1.8 or higher

OpenCV 4.x or higher

# Installation

# Clone this repository:

git clone https://github.com/sanjay-ks23/yolov7_smart_car_parking_system.git

# Implementation

Download the pre-trained YOLOv7 weights file from the official repository:

wget https://github.com/WongKinYiu/yolov7/raw/master/assets/yolov7.pt

Along with this download the YOLOv7 detection pre-trained model 

git clone https://github.com/WongKinYiu/yolov7

# Training data

Data used in this solution is CNR Car parking dataset (CNR-EXT_FULL_IMAGE_1000x750) for solution demonstration. This dataset is for visual occupancy of car parking lots and contains images captured in 3 different weather conditions : rainy, overcast & sunny. This variant of the dataset contains full frames (complete view of the parking lot) similar to the kind of input for the problem statement at hand.

Resolution – 1000x750

# Run the detect.py script to start the parking system:

python detect.py --weights yolov7.pt --source images/image1.jpg --classes 0 2 8 --y yolo-coco

This prints out a image that detects all cars in the parking space and a txt file that has all the annotations

The image generated is as follows:

![2015-12-03_1218](https://user-images.githubusercontent.com/79295319/232312535-7b6e33f1-c21a-4e0c-bc70-c82129c5d793.jpg)

# Run the detect1.py script to start the parking system:

python detect1.py --weights yolov7.pt --source images/image2.jpg --classes 0 2 8 --y yolo-coco

The final detection gives out the following image:

![2015-12-03_0948](https://user-images.githubusercontent.com/79295319/232312574-da07f49b-3336-4857-b426-5f0302ad3baa.jpg)

This code tries to compare the annotation generated by the previous code with new feed and print out regions with free spaces along with the free spaces list.


